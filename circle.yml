machine:
  services:
    - docker
  java:

dependencies:
  override:
    - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASSWORD
    - docker info
    - docker pull $ML8_LATEST_DOCKER_IMAGE

test:
  override:
    - docker run --name ml -d -p 8000:8000 -p 8001:8001 -p 8002:8002 -p 8200:8200 $ML8_LATEST_DOCKER_IMAGE
    - sleep 5
    - ./gradlew :core:mlInit -PmlHost=localhost
    - ./gradlew :core:mlInstallAdmin -PmlHost=localhost -PmlAdminPassword=admin -PmlAdminUsername=admin
    - ./gradlew :core:mlDeploy -PmlHost=localhost --info
    - ./gradlew :core:test --info